import { Args, Query, Resolver } from '@nestjs/graphql';
import { Vulnerability } from 'models/vulnerability.model';
import { VulnerabilityService } from './vulnerability.service';

@Resolver(() => Vulnerability)
export class VulnerabilityResolver {
  constructor(private readonly vulnerabilityService: VulnerabilityService) {}

  @Query(() => [Vulnerability])
  async getVulnerabilitiesByClientId(
    @Args('clientId') clientId: string,
  ): Promise<Vulnerability[]> {
    return await this.vulnerabilityService.findByClientId(clientId);
  }
}
